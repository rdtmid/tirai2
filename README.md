# TorWatch Intelligence

A professional-grade intelligence dashboard designed for law enforcement and security research professionals to simulate crawling, analyzing, and visualizing dark web (TOR) hidden services.

## Features

- **Network Graph Topology:** Visualizes relationships between hidden services using force-directed graphs.
- **AI Analyst:** Integration with Google Gemini for threat scoring, entity extraction, and risk assessment.
- **Live Crawler Simulation:** Simulates the discovery and indexing of .onion sites.
- **Crypto Forensics:** Real-time Bitcoin wallet analysis using BlockCypher.
- **Host Recon:** Infrastructure analysis and IP geolocation.
- **Case Management:** Digital evidence locker and investigation tracking.
- **Activity Logs:** Audit trail of all system operations.

---

## Deployment Guide (Ubuntu 22.04)

This guide details the steps to deploy the TorWatch frontend application on a fresh Ubuntu 22.04 LTS server using Nginx as a web server.

### 1. System Requirements

*   **OS:** Ubuntu 22.04 LTS
*   **CPU:** 1 vCPU (minimum), 2 vCPU (recommended)
*   **RAM:** 1GB (minimum), 2GB (recommended)
*   **Disk:** 10GB SSD
*   **Network:** Public IPv4 address with ports 80 (HTTP) and 443 (HTTPS) open.

### 2. Initial Server Setup

Update your system packages to the latest versions:

```bash
sudo apt update && sudo apt upgrade -y
sudo apt install curl git unzip -y
```

### 3. Install Node.js (v20 LTS)

The application requires Node.js to build the production assets.

```bash
# Download and setup NodeSource repository
curl -fsSL https://deb.nodesource.com/setup_20.x | sudo -E bash -

# Install Node.js
sudo apt install -y nodejs

# Verify installation
node -v
npm -v
```

### 4. Install Nginx Web Server

Nginx will serve the static files generated by the React build process.

```bash
sudo apt install nginx -y

# Start and enable Nginx
sudo systemctl start nginx
sudo systemctl enable nginx
```

### 5. Application Setup

#### Clone the Repository
Replace `[your-repo-url]` with the actual URL of your git repository.

```bash
cd /var/www
sudo git clone [your-repo-url] torwatch
cd torwatch
```

*Note: If you do not have a git repo, you can upload the project files via SFTP to `/var/www/torwatch`.*

#### Install Dependencies

```bash
sudo npm install
```

#### Configure Environment Variables

Create a `.env` file in the root directory to store your API keys.

```bash
sudo nano .env
```

Paste the following content (replace with your actual keys):

```env
# Google Gemini API Key for AI Analysis
API_KEY=your_google_gemini_api_key_here

# Optional: BlockCypher Token for higher rate limits in Crypto Trace
BLOCKCYPHER_TOKEN=your_token_here
```

Save and exit (`Ctrl+O`, `Enter`, `Ctrl+X`).

#### Build the Application

This compiles the TypeScript and React code into static HTML/CSS/JS files optimized for production.

```bash
sudo npm run build
```

*Depending on your build tool (Vite/CRA), this will create a `dist` or `build` directory.*

### 6. Configure Nginx

Create a new server block configuration for TorWatch.

```bash
sudo nano /etc/nginx/sites-available/torwatch
```

Paste the following configuration. **Important:** Ensure `root` points to your build folder (usually `/var/www/torwatch/dist` or `/var/www/torwatch/build`).

```nginx
server {
    listen 80;
    server_name your_domain_or_ip;

    root /var/www/torwatch/dist; # Change to /build if using Create React App
    index index.html;

    location / {
        # This is crucial for React Router (Single Page Apps)
        try_files $uri $uri/ /index.html;
    }

    # Optional: Proxy API requests if you have a backend running on port 3001
    location /api {
        proxy_pass http://localhost:3001;
        proxy_http_version 1.1;
        proxy_set_header Upgrade $http_upgrade;
        proxy_set_header Connection 'upgrade';
        proxy_set_header Host $host;
        proxy_cache_bypass $http_upgrade;
    }
}
```

Save and exit.

#### Activate the Configuration

```bash
# Link the configuration to sites-enabled
sudo ln -s /etc/nginx/sites-available/torwatch /etc/nginx/sites-enabled/

# Remove the default Nginx configuration
sudo rm /etc/nginx/sites-enabled/default

# Test Nginx for syntax errors
sudo nginx -t

# Restart Nginx to apply changes
sudo systemctl restart nginx
```

### 7. Configure Firewall

Allow web traffic through the firewall.

```bash
sudo ufw allow 'Nginx Full'
sudo ufw allow OpenSSH
sudo ufw enable
```

### 8. Access the Application

Open your web browser and navigate to your server's IP address (e.g., `http://192.0.2.1`). You should see the TorWatch dashboard.

---

## Troubleshooting

- **404 on Refresh:** If you refresh the page and get a 404 error, ensure the `try_files $uri $uri/ /index.html;` line exists in your Nginx config.
- **Permission Errors:** Ensure the `/var/www/torwatch` directory is readable by the Nginx user (`www-data`).
  ```bash
  sudo chown -R www-data:www-data /var/www/torwatch
  sudo chmod -R 755 /var/www/torwatch
  ```
- **API Issues:** If AI analysis fails, check the browser console. Since this is a client-side app, ensure the `API_KEY` was correctly embedded during the build process.
